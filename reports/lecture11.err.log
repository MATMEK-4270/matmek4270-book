Traceback (most recent call last):
  File "/Users/mikaelmortensen/opt/anaconda3/envs/book/lib/python3.11/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/Users/mikaelmortensen/opt/anaconda3/envs/book/lib/python3.11/site-packages/nbclient/client.py", line 1305, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mikaelmortensen/opt/anaconda3/envs/book/lib/python3.11/site-packages/jupyter_core/utils/__init__.py", line 173, in wrapped
    return loop.run_until_complete(inner)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mikaelmortensen/opt/anaconda3/envs/book/lib/python3.11/asyncio/base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/mikaelmortensen/opt/anaconda3/envs/book/lib/python3.11/site-packages/nbclient/client.py", line 705, in async_execute
    await self.async_execute_cell(
  File "/Users/mikaelmortensen/opt/anaconda3/envs/book/lib/python3.11/site-packages/nbclient/client.py", line 1058, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/Users/mikaelmortensen/opt/anaconda3/envs/book/lib/python3.11/site-packages/nbclient/client.py", line 914, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
from shenfun import FunctionSpace, TestFunction, TrialFunction, inner, Dx

N = 40
VN = FunctionSpace(N+3, 'L', bc=(0, 0))
u = TrialFunction(VN)
v = TestFunction(VN)
S = inner(Dx(u, 0, 1), Dx(v, 0, 1))
b = inner(-f, v)
uh = S.solve(b.copy())
fig = plt.figure(figsize=(4, 3))
plt.loglog(np.arange(0, N+1, 2), abs(uh[:-2:2]), '*');
------------------


[0;31m---------------------------------------------------------------------------[0m
[0;31mImportError[0m                               Traceback (most recent call last)
Cell [0;32mIn[5], line 4[0m
[1;32m      1[0m [38;5;28;01mfrom[39;00m [38;5;21;01mshenfun[39;00m [38;5;28;01mimport[39;00m FunctionSpace, TestFunction, TrialFunction, inner, Dx
[1;32m      3[0m N [38;5;241m=[39m [38;5;241m40[39m
[0;32m----> 4[0m VN [38;5;241m=[39m [43mFunctionSpace[49m[43m([49m[43mN[49m[38;5;241;43m+[39;49m[38;5;241;43m3[39;49m[43m,[49m[43m [49m[38;5;124;43m'[39;49m[38;5;124;43mL[39;49m[38;5;124;43m'[39;49m[43m,[49m[43m [49m[43mbc[49m[38;5;241;43m=[39;49m[43m([49m[38;5;241;43m0[39;49m[43m,[49m[43m [49m[38;5;241;43m0[39;49m[43m)[49m[43m)[49m
[1;32m      5[0m u [38;5;241m=[39m TrialFunction(VN)
[1;32m      6[0m v [38;5;241m=[39m TestFunction(VN)

File [0;32m~/MySoftware/shenfun/shenfun/forms/arguments.py:233[0m, in [0;36mFunctionSpace[0;34m(N, family, bc, dtype, quad, domain, scaled, padding_factor, basis, dealias_direct, coordinates, **kw)[0m
[1;32m    230[0m             [38;5;28;01mraise[39;00m [38;5;167;01mRuntimeError[39;00m
[1;32m    231[0m         B [38;5;241m=[39m bases[[38;5;124m'[39m[38;5;124m'[39m[38;5;241m.[39mjoin(key)]
[0;32m--> 233[0m     [38;5;28;01mreturn[39;00m [43mB[49m[43m([49m[43mN[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mpar[49m[43m)[49m
[1;32m    235[0m [38;5;28;01melif[39;00m family[38;5;241m.[39mlower() [38;5;129;01min[39;00m ([38;5;124m'[39m[38;5;124mchebyshevu[39m[38;5;124m'[39m, [38;5;124m'[39m[38;5;124mu[39m[38;5;124m'[39m):
[1;32m    236[0m     [38;5;28;01mfrom[39;00m [38;5;21;01mshenfun[39;00m [38;5;28;01mimport[39;00m chebyshevu

File [0;32m~/MySoftware/shenfun/shenfun/legendre/bases.py:371[0m, in [0;36mShenDirichlet.__init__[0;34m(self, N, quad, bc, domain, dtype, scaled, padding_factor, dealias_direct, coordinates, **kw)[0m
[1;32m    369[0m [38;5;28;01mdef[39;00m [38;5;21m__init__[39m([38;5;28mself[39m, N, quad[38;5;241m=[39m[38;5;124m"[39m[38;5;124mLG[39m[38;5;124m"[39m, bc[38;5;241m=[39m([38;5;241m0[39m, [38;5;241m0[39m), domain[38;5;241m=[39m([38;5;241m-[39m[38;5;241m1[39m, [38;5;241m1[39m), dtype[38;5;241m=[39m[38;5;28mfloat[39m,
[1;32m    370[0m              scaled[38;5;241m=[39m[38;5;28;01mFalse[39;00m, padding_factor[38;5;241m=[39m[38;5;241m1[39m, dealias_direct[38;5;241m=[39m[38;5;28;01mFalse[39;00m, coordinates[38;5;241m=[39m[38;5;28;01mNone[39;00m, [38;5;241m*[39m[38;5;241m*[39mkw):
[0;32m--> 371[0m     [43mCompositeBase[49m[38;5;241;43m.[39;49m[38;5;21;43m__init__[39;49m[43m([49m[38;5;28;43mself[39;49m[43m,[49m[43m [49m[43mN[49m[43m,[49m[43m [49m[43mquad[49m[38;5;241;43m=[39;49m[43mquad[49m[43m,[49m[43m [49m[43mdomain[49m[38;5;241;43m=[39;49m[43mdomain[49m[43m,[49m[43m [49m[43mdtype[49m[38;5;241;43m=[39;49m[43mdtype[49m[43m,[49m[43m [49m[43mbc[49m[38;5;241;43m=[39;49m[43mbc[49m[43m,[49m[43m [49m[43mscaled[49m[38;5;241;43m=[39;49m[43mscaled[49m[43m,[49m
[1;32m    372[0m [43m                           [49m[43mpadding_factor[49m[38;5;241;43m=[39;49m[43mpadding_factor[49m[43m,[49m[43m [49m[43mdealias_direct[49m[38;5;241;43m=[39;49m[43mdealias_direct[49m[43m,[49m
[1;32m    373[0m [43m                           [49m[43mcoordinates[49m[38;5;241;43m=[39;49m[43mcoordinates[49m[43m)[49m
[1;32m    374[0m     [38;5;28mself[39m[38;5;241m.[39m_stencil [38;5;241m=[39m {[38;5;241m0[39m: [38;5;241m1[39m, [38;5;241m2[39m: [38;5;241m-[39m[38;5;241m1[39m}
[1;32m    375[0m     [38;5;28;01mif[39;00m [38;5;28mself[39m[38;5;241m.[39mis_scaled():

File [0;32m~/MySoftware/shenfun/shenfun/spectralbase.py:1419[0m, in [0;36mgetCompositeBase.<locals>.CompositeBase.__init__[0;34m(self, *args, **kwargs)[0m
[1;32m   1417[0m bc [38;5;241m=[39m kwargs[38;5;241m.[39mpop([38;5;124m'[39m[38;5;124mbc[39m[38;5;124m'[39m, [38;5;28;01mNone[39;00m)
[1;32m   1418[0m scaled [38;5;241m=[39m kwargs[38;5;241m.[39mpop([38;5;124m'[39m[38;5;124mscaled[39m[38;5;124m'[39m, [38;5;28;01mNone[39;00m)
[0;32m-> 1419[0m [43mOrthogonal[49m[38;5;241;43m.[39;49m[38;5;21;43m__init__[39;49m[43m([49m[38;5;28;43mself[39;49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
[1;32m   1420[0m [38;5;28;01mif[39;00m bc [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m:
[1;32m   1421[0m     [38;5;28;01mfrom[39;00m [38;5;21;01mshenfun[39;00m[38;5;21;01m.[39;00m[38;5;21;01mtensorproductspace[39;00m [38;5;28;01mimport[39;00m BoundaryValues

File [0;32m~/MySoftware/shenfun/shenfun/legendre/bases.py:115[0m, in [0;36mOrthogonal.__init__[0;34m(self, N, quad, domain, dtype, padding_factor, dealias_direct, coordinates, **kw)[0m
[1;32m    110[0m [38;5;28;01mdef[39;00m [38;5;21m__init__[39m([38;5;28mself[39m, N, quad[38;5;241m=[39m[38;5;124m"[39m[38;5;124mLG[39m[38;5;124m"[39m, domain[38;5;241m=[39m([38;5;241m-[39m[38;5;241m1[39m, [38;5;241m1[39m), dtype[38;5;241m=[39m[38;5;28mfloat[39m, padding_factor[38;5;241m=[39m[38;5;241m1[39m,
[1;32m    111[0m              dealias_direct[38;5;241m=[39m[38;5;28;01mFalse[39;00m, coordinates[38;5;241m=[39m[38;5;28;01mNone[39;00m, [38;5;241m*[39m[38;5;241m*[39mkw):
[1;32m    112[0m     JacobiBase[38;5;241m.[39m[38;5;21m__init__[39m([38;5;28mself[39m, N, quad[38;5;241m=[39mquad, alpha[38;5;241m=[39m[38;5;241m0[39m, beta[38;5;241m=[39m[38;5;241m0[39m, domain[38;5;241m=[39mdomain, dtype[38;5;241m=[39mdtype,
[1;32m    113[0m                         padding_factor[38;5;241m=[39mpadding_factor, dealias_direct[38;5;241m=[39mdealias_direct,
[1;32m    114[0m                         coordinates[38;5;241m=[39mcoordinates)
[0;32m--> 115[0m     [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mplan[49m[43m([49m[38;5;28;43mint[39;49m[43m([49m[43mpadding_factor[49m[38;5;241;43m*[39;49m[43mN[49m[43m)[49m[43m,[49m[43m [49m[38;5;241;43m0[39;49m[43m,[49m[43m [49m[43mdtype[49m[43m,[49m[43m [49m[43m{[49m[43m}[49m[43m)[49m

File [0;32m~/MySoftware/shenfun/shenfun/legendre/bases.py:285[0m, in [0;36mOrthogonal.plan[0;34m(self, shape, axis, dtype, options)[0m
[1;32m    283[0m threads [38;5;241m=[39m opts[[38;5;124m'[39m[38;5;124mthreads[39m[38;5;124m'[39m]
[1;32m    284[0m U [38;5;241m=[39m fftw[38;5;241m.[39maligned(shape, dtype[38;5;241m=[39m[38;5;28mfloat[39m)
[0;32m--> 285[0m xfftn_fwd [38;5;241m=[39m [43mDLT[49m[43m([49m[43mU[49m[43m,[49m[43m [49m[43maxes[49m[38;5;241;43m=[39;49m[43m([49m[43maxis[49m[43m,[49m[43m)[49m[43m,[49m[43m [49m[43mkind[49m[38;5;241;43m=[39;49m[38;5;124;43m'[39;49m[38;5;124;43mscalar product[39;49m[38;5;124;43m'[39;49m[43m,[49m[43m [49m[43mthreads[49m[38;5;241;43m=[39;49m[43mthreads[49m[43m,[49m[43m [49m[43mflags[49m[38;5;241;43m=[39;49m[43mflags[49m[43m)[49m
[1;32m    286[0m V [38;5;241m=[39m xfftn_fwd[38;5;241m.[39moutput_array
[1;32m    287[0m xfftn_bck [38;5;241m=[39m DLT(V, axes[38;5;241m=[39m(axis,), kind[38;5;241m=[39m[38;5;124m'[39m[38;5;124mbackward[39m[38;5;124m'[39m, threads[38;5;241m=[39mthreads, flags[38;5;241m=[39mflags, output_array[38;5;241m=[39mU)

File [0;32m~/MySoftware/shenfun/shenfun/legendre/dlt.py:101[0m, in [0;36mDLT.__init__[0;34m(self, input_array, s, axes, threads, kind, flags, output_array)[0m
[1;32m     99[0m [38;5;28;01mdef[39;00m [38;5;21m__init__[39m([38;5;28mself[39m, input_array, s[38;5;241m=[39m[38;5;28;01mNone[39;00m, axes[38;5;241m=[39m([38;5;241m-[39m[38;5;241m1[39m,), threads[38;5;241m=[39m[38;5;241m1[39m, kind[38;5;241m=[39m[38;5;124m'[39m[38;5;124mbackward[39m[38;5;124m'[39m,
[1;32m    100[0m              flags[38;5;241m=[39m(FFTW_MEASURE, FFTW_PRESERVE_INPUT), output_array[38;5;241m=[39m[38;5;28;01mNone[39;00m):
[0;32m--> 101[0m     [38;5;28;01mfrom[39;00m [38;5;21;01m.[39;00m [38;5;28;01mimport[39;00m fastgl
[1;32m    102[0m     [38;5;28;01mif[39;00m [38;5;28misinstance[39m(axes, [38;5;28mtuple[39m):
[1;32m    103[0m         [38;5;28;01massert[39;00m [38;5;28mlen[39m(axes) [38;5;241m==[39m [38;5;241m1[39m

File [0;32m~/MySoftware/shenfun/shenfun/legendre/fastgl/__init__.py:2[0m
[1;32m      1[0m [38;5;28;01mtry[39;00m:
[0;32m----> 2[0m     [38;5;28;01mfrom[39;00m [38;5;21;01m.[39;00m [38;5;28;01mimport[39;00m fastgl_wrap
[1;32m      3[0m [38;5;28;01mexcept[39;00m [38;5;167;01mModuleNotFoundError[39;00m:
[1;32m      4[0m     [38;5;28mprint[39m([38;5;124m'[39m[38;5;124mfastgl not found[39m[38;5;124m'[39m)

[0;31mImportError[0m: cannot import name 'fastgl_wrap' from partially initialized module 'shenfun.legendre.fastgl' (most likely due to a circular import) (/Users/mikaelmortensen/MySoftware/shenfun/shenfun/legendre/fastgl/__init__.py)

